<table class="min-w-full border border-gray-200 rounded overflow-hidden">
  <thead class="bg-gray-100">
    <tr>
      <th class="px-4 py-2 border-b text-left">Title</th>
      <th class="px-4 py-2 border-b text-left">Description</th>
      <% if active_view.in?(%w[admin manager]) %>
        <th class="px-4 py-2 border-b text-left">Assigned To</th>
      <% end %>
      <th class="px-4 py-2 border-b text-left">Due Date</th>
      <th class="px-4 py-2 border-b text-left">Status</th>
      <% if active_view == "employee" %>
        <th class="px-4 py-2 border-b text-left">Action</th>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% tasks_to_show.each do |task| %>
      <tr class="hover:bg-gray-50">
        <td class="px-4 py-2 border-b"><%= task.title %></td>
        <td class="px-4 py-2 border-b"><%= task.description %></td>

        <% if active_view.in?(%w[admin manager]) %>
          <td class="px-4 py-2 border-b"><%= task.user&.name || "Unassigned" %></td>
        <% end %>

        <td class="px-4 py-2 border-b"><%= task.due_date&.strftime("%d %b %Y") %></td>
        <td class="px-4 py-2 border-b">
          <span class="<%= task.status == 'completed' ? 'text-green-600' : task.status == 'overdue' ? 'text-red-600' : 'text-yellow-600' %> font-semibold">
            <%= task.status.capitalize %>
          </span>
        </td>

        <% if active_view == "employee" %>
          <td class="px-4 py-2 border-b">
            <% if task.status != "completed" %>
              <%= button_to "Mark Complete",
                            mark_complete_dashboard_path(task, view: "employee", employee_id: active_employee&.id),
                            method: :patch,
                            class: "bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700",
                            form: { data: { turbo_stream: true } } %>
            <% else %>
              <span class="text-gray-500">Done</span>
            <% end %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<% if tasks_to_show.empty? %>
  <p class="mt-4 text-gray-500">No tasks to display.</p>
<% end %>
