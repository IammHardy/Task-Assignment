<div class="mb-4 p-3 border rounded flex space-x-2">
  <%= link_to "Admin", dashboard_index_path(view: "admin"), class: "px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" %>
  <%= link_to "Manager", dashboard_index_path(view: "manager"), class: "px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700" %>
  <%= link_to "Employee", dashboard_index_path(view: "employee"), class: "px-3 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600" %>
</div>


<% if @active_view == "admin" %>
  <h2 class="text-2xl font-semibold mb-4 text-gray-700">All Tasks (Admin)</h2>

  <%= render "dashboard/tasks_table",
             tasks_to_show: @tasks_to_show,
             active_view: "admin",
             current_user: @current_user %>

<!-- Manager Dropdown -->
<% if @active_view == "manager" %>
  <div class="mb-4 p-3 border rounded flex space-x-2 items-center">
    <label class="font-semibold">Select Manager:</label>
    <%= form_with url: dashboard_index_path, method: :get, local: true do |f| %>
      <%= f.hidden_field :view, value: "manager" %>
      <%= f.select :manager_id, options_from_collection_for_select(@managers, :id, :name, params[:manager_id]), { prompt: "All Managers" } %>
      <%= f.submit "Switch", class: "bg-green-600 text-white px-3 py-1 rounded" %>
    <% end %>
  </div>
<% end %>


<% elsif @active_view == "employee" %>
  <h2 class="text-2xl font-semibold mb-4 text-gray-700">My Tasks</h2>

  <%= render "dashboard/tasks_table",
             tasks_to_show: @tasks_to_show,
             active_view: "employee",
             active_employee: @active_employee,
             current_user: @current_user %>
<% end %>

<div id="ai_summary_frame">
  <%= @ai_summary if defined?(@ai_summary) %>
</div>
