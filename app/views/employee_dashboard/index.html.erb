<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

  <!-- Page Title & Welcome -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800">Employee Dashboard</h1>
    <p class="text-gray-700 mt-2">Welcome, <span class="font-semibold"><%= @employee.name %></span></p>
  </div>

  <!-- Tasks Section -->
  <h2 class="text-2xl font-semibold mb-6 text-gray-700">Your Tasks</h2>

  <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
    <% @tasks.each do |task| %>
      <%= turbo_frame_tag "task_#{task.id}" do %>
        <div class="bg-white shadow-lg rounded-lg p-6 border border-gray-200 hover:shadow-xl transition">
          
          <!-- Task Header -->
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800 truncate"><%= task.title || "-" %></h3>
            <span class="text-sm font-medium text-gray-500">Due: <%= task.due_date ? task.due_date.strftime("%b %d, %Y") : "-" %></span>
          </div>

          <!-- Description -->
          <p class="text-gray-700 mb-4 line-clamp-3"><strong>Description:</strong> <%= task.description || "-" %></p>

          <!-- Status Badge -->
          <% status_classes = case task.status
              when "pending" then "bg-yellow-100 text-yellow-800"
              when "in_progress" then "bg-blue-100 text-blue-800"
              when "completed" then "bg-green-100 text-green-800"
              else "bg-gray-100 text-gray-800"
            end %>
          <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold <%= status_classes %> mb-4">
            <%= task.status.humanize %>
          </span>

          <!-- Status Update Form -->
          <%= form_with model: task, url: task_path(task), method: :patch, data: { turbo_frame: "task_#{task.id}" }, class: "flex items-center gap-2" do |f| %>
            <%= f.label :status, class: "sr-only" %>
            <%= f.select :status, Task.statuses.keys.map { |s| [s.humanize, s] }, selected: task.status, class: "border rounded px-2 py-1 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500" %>
            <%= f.submit "Update", class: "bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded shadow transition" %>
          <% end %>

        </div>
      <% end %>
    <% end %>
  </div>

  <!-- Success/Info Messages -->
  <turbo-frame id="task-msg"></turbo-frame>

  <!-- Optional: Turbo Streams for live updates -->
  <%= turbo_stream_from "task_stats" %>
  <%= turbo_stream_from "tasks_table" %>
</div>
